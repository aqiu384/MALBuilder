<form name="update" method="POST" id="updateanimeform">
    {{ form.hidden_tag() }}
    {% for subform in form.getSubforms(fields) %}
        <div class="well">
            <div class="row">
                <div class="col-md-2">
                    <img src="{{ subform.result.imgLink }}" width="100">
                </div>
                <div class="col-md-7">
                    <b>{{ subform.result.get('title') }}</b><br>
                    Status: {{ subform.result.get('myStatus') }}<br>
                    Alternative Title: {{ subform.result.get('japTitle') }}, {{ subform.result.get('engTitle') }}<br>
                    Score: {{ subform.result.get('score') }}<br>
                    Episodes: {{ subform.result.get('episodes') }}<br>
                    Genre(s): {{ subform.result.get('genres') }}<br>
                </div>
                <div class="col-md-3">
                    My Status: {{ subform.myStatus(class_="checkbox-grid1") }} <br>

                    My Score: {{ subform.myScore(class_="checkbox-grid1") }} <br>

                    My Episodes Watched: {{ subform.myEpisodes(placeholder="1-{}".format(subform.result.get('episodes'))) }}<br>

                    {{ subform.malId() }}

                    <button type="submit" class="btn btn-lg btn-danger" name="delete" value="{{ subform.result.get('malId') }}">Delete Anime</button>
                </div>
            </div>
        </div>
    {% endfor %}
</form>

<script>
$(function(){
  enter_pressed = false;

  $('#updateanimeform :input').change(function() {
    mal_id = $(this).siblings('input:hidden').val();
    $.ajax({
      type: 'POST',
      url: '/update_anime',
      data: {
        anime_id: mal_id,
        field: $(this).attr('name'),
        value: $(this).val()
      }
    })
  });

  $('#updateanimeform').keypress(function(e) {
    enter_pressed = (e.which == 13);
  });

  $('#updateanimeform button[name="delete"]').click(function() {
    event.preventDefault();
    if (!enter_pressed) {
      closest = $(this).closest('div[class="well"]');
      $.ajax({
        type: 'POST',
        url: '/delete_anime',
        data: {
          anime_id: $(this).val()
        }
      })
      .done(function(response) {
        closest.remove();
      });
    }
    enter_pressed = false;
  });
});
</script>